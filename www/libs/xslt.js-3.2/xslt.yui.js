function Transformation(){var xml;var xmlDoc;var xslt;var xsltDoc;var callback=function(){};var transformed=false;this.getXml=function(){return xml};this.getXmlDocument=function(){return xmlDoc};this.setXml=function(x){xml=x;return this};this.getXslt=function(){return xslt};this.getXsltDocument=function(){return xsltDoc};this.setXslt=function(x){xslt=x;return this};this.getCallback=function(){return callback};this.setCallback=function(c){callback=c;return this};this.transform=function(target){if(!browserSupportsXSLT()){return }var str=/^\s*</;var t=this;if(document.recalc){var change=function(){var c="complete";if(xm.readyState==c&&xs.readyState==c){window.setTimeout(function(){xmlDoc=xm.XMLDocument;xsltDoc=xs.XMLDocument;callback(t);document.all[target].innerHTML=xm.transformNode(xs.XMLDocument)},50)}};var xm=document.createElement("xml");xm.onreadystatechange=change;xm[str.test(xml)?"innerHTML":"src"]=xml;var xs=document.createElement("xml");xs.onreadystatechange=change;xs[str.test(xslt)?"innerHTML":"src"]=xslt;with(document.body){insertBefore(xm);insertBefore(xs)}}else{var transformed=false;var xm={readyState:4};var xs={readyState:4};var change=function(){if(xm.readyState==4&&xs.readyState==4&&!transformed){xmlDoc=xm.responseXML;xsltDoc=xs.responseXML;var resultDoc;var processor=new XSLTProcessor();if(typeof processor.transformDocument=="function"){resultDoc=document.implementation.createDocument("","",null);processor.transformDocument(xm.responseXML,xs.responseXML,resultDoc,null);var out=new XMLSerializer().serializeToString(resultDoc);callback(t);document.getElementById(target).innerHTML=out}else{processor.importStylesheet(xs.responseXML);resultDoc=processor.transformToFragment(xm.responseXML,document);callback(t);document.getElementById(target).innerHTML="";document.getElementById(target).appendChild(resultDoc)}transformed=true}};if(str.test(xml)){xm.responseXML=new DOMParser().parseFromString(xml,"text/xml")}else{xm=new XMLHttpRequest();xm.onreadystatechange=change;xm.open("GET",xml);xm.send(null)}if(str.test(xslt)){xs.responseXML=new DOMParser().parseFromString(xslt,"text/xml");change()}else{xs=new XMLHttpRequest();xs.onreadystatechange=change;xs.open("GET",xslt);xs.send(null)}}}}function browserSupportsXSLT(){var B=false;if(document.recalc){B=true}else{if(window.XMLHttpRequest!=undefined&&window.XSLTProcessor!=undefined){var A=new XSLTProcessor();if(typeof A.transformDocument=="function"){B=window.XMLSerializer!=undefined}else{B=true}}}return B};